まず, 最後に使うタクシーは最低M-D以上移動できなければならない. このようなタクシーが存在しない場合は移動することができない.

n台目を利用した後のスタートからの移動距離をP[n]とする. P[n] ≧ D ならば, 移動力M-D以上のタクシーでゴールすることができるので, P[n] < Dを仮定する. n番目に使うタクシーの移動力をA[n]とすると,

P[n+1] = (A[n+1] - (D - P[n])) + P[n]
       = 2P[n] + A[n+1] - D

となる. これを繰り返して,

P[n] = 2P[n-1] + A[n] - D
     = 2(2P[n-2] + A[n-1] - D) - D
     = 4P[n-2] + 2A[n-1] - 3D
     = 8P[n-3] + 4A[n-2] + 2A[n-1] - 7D
     ...
     = 2^k・P[n-k] + 2^(k-1)・A[n-k+1] + ... + 2A[n-1] - (2^k-1)・D
     ...
     = 2^n・P[0] + 2^(n-1)・A[1] + ... + 2A[n-1] - (2^n-1)・D
     = 2^(n-1)・A[1] + ... + 2A[n-1] - (2^n-1)・D

この式から分かるように, 早く使うタクシーほど距離への影響が大きい, つまり移動力が大きいタクシーほど早く使えばよいということが分かる.

次に, 最後に使うタクシーについてであるが, n台使った後に移動力X(X≧M-D)のタクシーを使ってゴールする場合, ゴールに必要な条件は 

P[n] ≧ D または 2(D-P[n]) + (M-D) ≦ X ･･･ ①

となる. ここで E(X) = 2(D-P[n]) + (M-D) - Xとおくと, 移動力Xのタクシーの代わりにn台目までに使用した移動力Y(X≧Y)のタクシーを使用した場合,

・P[n]は最低でも2(X-Y)増加し,元々P[n] ≧ D ならば交換後もP[n] ≧ Dが成り立つ.
・Eについては, -2P[n]の部分が最低でも4(X-Y)減少し, -Xの部分が(X-Y)増加するため, 結果的に最低でも3(X-Y)減少する. よって元々 E(X) ≧ E(Y) であり, E(X) ≦ 0 ならば 交換後も E(Y) ≦ 0 が成り立つ.

以上より, Xの代わりにYを使う方がよい, つまり最後に使うタクシーの移動力は小さければ小さいほどよいことが分かる. しかしM-Dより小さくはできないため, N台のタクシーの中で移動力がM-D以上で一番小さいものを使えばよい.

以上より, N台のタクシーについて移動力でソートし, 移動力がM-D以上のタクシーを最後の移動用にとっておき, 他については大きい順に使っていって, ①が満たされた時点でその時までに使ったタクシーの台数+1が答えとなる. ただし

・一台で移動が完了する場合
・途中で移動ができなくなる場合
・N台使っても①が満たされない場合
・移動力M-D以上のタクシーが存在しない場合
・最後の移動用のタクシーを用意していたが, それを使うまでもなく移動が完了してしまう場合

などのコーナーケースがあるので注意する必要がある.
